"use strict";(self.webpackChunkproductify=self.webpackChunkproductify||[]).push([[204],{5204:(D,u,r)=>{r.r(u),r.d(u,{CartComponent:()=>I});var m=r(6814),c=r(6223),l=r(2296),g=r(617),p=r(5195),h=r(6385),v=r(9038),x=r(4170),P=r(2032),C=r(2939),f=r(5940),M=r(8645),_=r(9773),t=r(9212),O=r(2623),y=r(2333),T=r(1896);function E(a,d){1&a&&(t.TgZ(0,"div",14),t._UZ(1,"mat-spinner",15),t.TgZ(2,"p"),t._uU(3,"Loading cart..."),t.qZA()())}function Z(a,d){1&a&&(t.TgZ(0,"mat-card",16)(1,"p"),t._uU(2,"Your cart is empty"),t.qZA()())}function b(a,d){if(1&a&&(t.TgZ(0,"div",33),t._uU(1),t.qZA()),2&a){const e=t.oxw().$implicit;t.xp6(1),t.Oqu(e.variant)}}function A(a,d){if(1&a){const e=t.EpF();t.TgZ(0,"mat-card",19)(1,"div",20),t._UZ(2,"img",21),t.TgZ(3,"div",22)(4,"div",23),t._uU(5),t.qZA(),t.YNc(6,b,2,1,"div",24),t.TgZ(7,"div",25),t._uU(8),t.ALo(9,"number"),t.qZA(),t.TgZ(10,"div",26)(11,"div",27)(12,"button",28),t.NdJ("click",function(){const o=t.CHM(e).$implicit,s=t.oxw(2);return t.KtG(s.decrement(o))}),t.TgZ(13,"mat-icon"),t._uU(14,"remove"),t.qZA()(),t.TgZ(15,"input",29),t.NdJ("ngModelChange",function(i){const s=t.CHM(e).$implicit;return t.KtG(s.quantity=i)})("change",function(){const o=t.CHM(e).$implicit,s=t.oxw(2);return t.KtG(s.updateQuantity(o))}),t.qZA(),t.TgZ(16,"button",30),t.NdJ("click",function(){const o=t.CHM(e).$implicit,s=t.oxw(2);return t.KtG(s.increment(o))}),t.TgZ(17,"mat-icon"),t._uU(18,"add"),t.qZA()()(),t.TgZ(19,"button",31),t.NdJ("click",function(){const o=t.CHM(e).$implicit,s=t.oxw(2);return t.KtG(s.remove(o))}),t.TgZ(20,"mat-icon"),t._uU(21,"delete"),t.qZA(),t._uU(22," Remove "),t.qZA()()(),t.TgZ(23,"div",32),t._uU(24),t.ALo(25,"number"),t.qZA()()()}if(2&a){const e=d.$implicit,n=t.oxw(2);t.xp6(2),t.Q6J("src",e.image||"assets/placeholder.png",t.LSH)("alt",e.productName),t.xp6(3),t.Oqu(e.productName||"Product"),t.xp6(1),t.Q6J("ngIf",e.variant),t.xp6(2),t.hij("\u20b9 ",t.xi3(9,11,e.price||0,"1.2-2"),""),t.xp6(4),t.Q6J("disabled",n.isProcessing),t.xp6(3),t.Q6J("ngModel",e.quantity)("disabled",n.isProcessing),t.xp6(1),t.Q6J("disabled",n.isProcessing),t.xp6(3),t.Q6J("disabled",n.isProcessing),t.xp6(5),t.hij("\u20b9 ",t.xi3(25,14,(e.price||0)*(e.quantity||1),"1.2-2"),"")}}function U(a,d){if(1&a&&(t.TgZ(0,"div",17),t.YNc(1,A,26,17,"mat-card",18),t.qZA()),2&a){const e=t.oxw();t.xp6(1),t.Q6J("ngForOf",e.items)}}let I=(()=>{class a{constructor(e,n,i,o){this.cartService=e,this.authService=n,this.snackBar=i,this.router=o,this.items=[],this.delivery=49,this.isLoading=!1,this.isProcessing=!1,this.userId=null,this.destroy$=new M.x}ngOnInit(){this.loadCart()}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}loadCart(){this.isLoading=!0;const e=this.authService.getCurrentUser();if(!e)return this.snackBar.open("Please login to view your cart","Close",{duration:3e3}),this.router.navigate(["/auth/login"]),void(this.isLoading=!1);this.userId=e.userId,this.cartService.setUserId(this.userId),this.cartService.getCart().pipe((0,_.R)(this.destroy$)).subscribe({next:n=>{this.items=n.items||[],this.isLoading=!1},error:n=>{console.error("Error loading cart:",n),404===n.status?(this.items=[],this.snackBar.open("Cart is empty.","Close",{duration:3e3}),this.isLoading=!1):(this.items=[],this.snackBar.open("Failed to load cart","Close",{duration:3e3}),this.isLoading=!1)}})}increment(e){e.quantity=(e.quantity||0)+1,this.updateQuantity(e)}decrement(e){e.quantity||(e.quantity=1),e.quantity>1&&(e.quantity--,this.updateQuantity(e))}updateQuantity(e){!this.userId||!e.productId||!e.quantity||(this.isProcessing=!0,this.cartService.updateItem(e.productId,e.quantity).pipe((0,_.R)(this.destroy$)).subscribe({next:n=>{this.items=n.items||[],this.isProcessing=!1},error:n=>{console.error("Error updating cart:",n),this.snackBar.open("Failed to update item quantity","Close",{duration:3e3}),this.isProcessing=!1}}))}remove(e){!this.userId||!e.productId||(this.isProcessing=!0,this.cartService.removeItem(e.productId).pipe((0,_.R)(this.destroy$)).subscribe({next:n=>{this.items=n.items||[],this.snackBar.open("Item removed from cart","Close",{duration:2e3}),this.isProcessing=!1},error:n=>{console.error("Error removing from cart:",n),this.snackBar.open("Failed to remove item","Close",{duration:3e3}),this.isProcessing=!1}}))}subtotal(){return this.items.reduce((e,n)=>e+(n.price||0)*(n.quantity||1),0)}total(){return this.subtotal()+(this.items.length?this.delivery:0)}checkout(){!this.userId||0===this.items.length||this.router.navigate(["/checkout"])}continueShopping(){this.router.navigate(["/products"])}static{this.\u0275fac=function(n){return new(n||a)(t.Y36(O.N),t.Y36(y.e),t.Y36(C.ux),t.Y36(T.F0))}}static{this.\u0275cmp=t.Xpm({type:a,selectors:[["app-cart"]],standalone:!0,features:[t.jDz],decls:35,vars:16,consts:[[1,"cart-container"],[1,"cart-grid"],[1,"items"],["class","loading-spinner",4,"ngIf"],["class","empty-card",4,"ngIf"],["class","items-list",4,"ngIf"],[1,"summary"],[1,"summary-card"],[1,"summary-header"],[1,"summary-row"],[1,"summary-row","small"],[1,"summary-row","total"],["mat-raised-button","","color","primary",1,"checkout",3,"disabled","click"],["mat-button","",1,"continue-shopping",3,"click"],[1,"loading-spinner"],["diameter","40"],[1,"empty-card"],[1,"items-list"],["class","item-card",4,"ngFor","ngForOf"],[1,"item-card"],[1,"item-row"],["onerror","this.src='https://via.placeholder.com/160x160?text=No+Image'",1,"thumb",3,"src","alt"],[1,"item-main"],[1,"title"],["class","variant",4,"ngIf"],[1,"price"],[1,"controls"],[1,"qty-controls"],["mat-mini-fab","","color","primary","aria-label","decrement",3,"disabled","click"],["type","number","min","1","max","999",1,"qty",3,"ngModel","disabled","ngModelChange","change"],["mat-mini-fab","","color","primary","aria-label","increment",3,"disabled","click"],["mat-button","","color","warn",1,"remove-btn",3,"disabled","click"],[1,"item-subtotal"],[1,"variant"]],template:function(n,i){1&n&&(t.TgZ(0,"div",0)(1,"h2"),t._uU(2,"Shopping Cart"),t.qZA(),t.TgZ(3,"div",1)(4,"section",2),t.YNc(5,E,4,0,"div",3)(6,Z,3,0,"mat-card",4)(7,U,2,1,"div",5),t.qZA(),t.TgZ(8,"aside",6)(9,"mat-card",7)(10,"div",8),t._uU(11,"Order Summary"),t.qZA(),t.TgZ(12,"div",9)(13,"div"),t._uU(14,"Subtotal"),t.qZA(),t.TgZ(15,"div"),t._uU(16),t.ALo(17,"number"),t.qZA()(),t.TgZ(18,"div",10)(19,"div"),t._uU(20,"Delivery"),t.qZA(),t.TgZ(21,"div"),t._uU(22),t.ALo(23,"number"),t.qZA()(),t._UZ(24,"mat-divider"),t.TgZ(25,"div",11)(26,"div"),t._uU(27,"Total"),t.qZA(),t.TgZ(28,"div"),t._uU(29),t.ALo(30,"number"),t.qZA()(),t.TgZ(31,"button",12),t.NdJ("click",function(){return i.checkout()}),t._uU(32," Proceed to Checkout "),t.qZA(),t.TgZ(33,"button",13),t.NdJ("click",function(){return i.continueShopping()}),t._uU(34," Continue Shopping "),t.qZA()()()()()),2&n&&(t.xp6(5),t.Q6J("ngIf",i.isLoading),t.xp6(1),t.Q6J("ngIf",!i.isLoading&&0===i.items.length),t.xp6(1),t.Q6J("ngIf",!i.isLoading&&i.items.length>0),t.xp6(9),t.hij("\u20b9 ",t.xi3(17,7,i.subtotal(),"1.2-2"),""),t.xp6(6),t.hij("\u20b9 ",t.xi3(23,10,i.items.length?i.delivery:0,"1.2-2"),""),t.xp6(7),t.hij("\u20b9 ",t.xi3(30,13,i.total(),"1.2-2"),""),t.xp6(2),t.Q6J("disabled",0===i.items.length||i.isProcessing))},dependencies:[m.ez,m.sg,m.O5,m.JJ,c.u5,c.Fj,c.wV,c.JJ,c.qQ,c.Fd,c.On,l.ot,l.lW,l.nh,g.Ps,g.Hw,p.QW,p.a8,h.t,h.d,v.ie,x.lN,P.c,C.ZX,f.Cq,f.Ou],styles:[".cart-container[_ngcontent-%COMP%]{max-width:1200px;margin:2rem auto;padding:1rem}h2[_ngcontent-%COMP%]{margin-bottom:1rem}.cart-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 320px;gap:1rem;align-items:start}.items[_ngcontent-%COMP%]{min-height:200px}.loading-spinner[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;padding:3rem;gap:1rem}.empty-card[_ngcontent-%COMP%]{padding:2rem;text-align:center}.items-list[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.75rem}.item-card[_ngcontent-%COMP%]{padding:.5rem .75rem;box-shadow:none}.item-row[_ngcontent-%COMP%]{display:flex;gap:1rem;align-items:center}.thumb[_ngcontent-%COMP%]{width:96px;height:96px;object-fit:cover;border-radius:8px;box-shadow:0 2px 6px #0000000f}.item-main[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.4rem;flex:1 1 auto}.title[_ngcontent-%COMP%]{font-weight:700;font-size:1.02rem}.variant[_ngcontent-%COMP%]{color:#0009;font-size:.95rem}.price[_ngcontent-%COMP%]{color:#000000d9;font-weight:600;margin-top:.25rem}.controls[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-top:.5rem}.qty-controls[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem}.qty-controls[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{width:36px;height:36px;min-width:36px}.qty[_ngcontent-%COMP%]{width:64px;padding:6px 8px;border-radius:6px;border:1px solid rgba(0,0,0,.12);text-align:center}.remove-btn[_ngcontent-%COMP%]{margin-left:.5rem}.item-subtotal[_ngcontent-%COMP%]{width:120px;text-align:right;font-weight:700}.summary-card[_ngcontent-%COMP%]{padding:1rem;position:sticky;top:100px;display:flex;flex-direction:column;gap:1rem;border-radius:8px}.summary-header[_ngcontent-%COMP%]{font-weight:700;font-size:1.05rem}.summary-row[_ngcontent-%COMP%]{display:flex;justify-content:space-between}.summary-row.small[_ngcontent-%COMP%]{color:#0009;font-size:.95rem}.summary-row.total[_ngcontent-%COMP%]{font-size:1.15rem;font-weight:800}.checkout[_ngcontent-%COMP%], .continue-shopping[_ngcontent-%COMP%]{width:100%}@media (max-width: 900px){.cart-grid[_ngcontent-%COMP%]{grid-template-columns:1fr}.item-subtotal[_ngcontent-%COMP%]{width:auto;text-align:left;margin-top:.5rem}.summary-card[_ngcontent-%COMP%]{position:relative;top:0}}"]})}}return a})()}}]);