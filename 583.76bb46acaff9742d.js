"use strict";(self.webpackChunkproductify=self.webpackChunkproductify||[]).push([[583],{4583:(_,m,n)=>{n.r(m),n.d(m,{WishlistComponent:()=>W});var p=n(6814),d=n(2296),u=n(617),l=n(5195),h=n(1476),f=n(2939),x=n(5940),v=n(8645),g=n(9773),t=n(9212),C=n(1474);let y=(()=>{class e{constructor(i){this.http=i,this.apiUrl="/api/v1/wishlists"}getAll(){return this.http.get(this.apiUrl)}getById(i){return this.http.get(`${this.apiUrl}/${i}`)}create(i){return this.http.post(this.apiUrl,i)}update(i,s){return this.http.put(`${this.apiUrl}/${i}`,s)}delete(i){return this.http.delete(`${this.apiUrl}/${i}`)}getUserWishlists(i){return this.http.get(`${this.apiUrl}/user/${i}`)}addToWishlist(i){return this.http.post(`${this.apiUrl}`,{productId:i})}removeFromWishlist(i){return this.http.delete(`${this.apiUrl}/product/${i}`)}static{this.\u0275fac=function(s){return new(s||e)(t.LFG(C.eN))}}static{this.\u0275prov=t.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"})}}return e})();var P=n(2623),I=n(2333);function Z(e,a){1&e&&(t.TgZ(0,"div",4),t._UZ(1,"mat-spinner",5),t.TgZ(2,"p"),t._uU(3,"Loading wishlist..."),t.qZA()())}function w(e,a){if(1&e){const i=t.EpF();t.TgZ(0,"mat-card",10)(1,"div",11),t._UZ(2,"img",12),t.qZA(),t.TgZ(3,"mat-card-content")(4,"h3",13),t._uU(5),t.qZA(),t.TgZ(6,"p",14),t._uU(7),t.ALo(8,"number"),t.qZA()(),t.TgZ(9,"mat-card-actions",15)(10,"button",16),t.NdJ("click",function(){const o=t.CHM(i).$implicit,c=t.oxw(2);return t.KtG(c.addToCart(o))}),t.TgZ(11,"mat-icon"),t._uU(12,"shopping_cart"),t.qZA(),t._uU(13," Add to cart "),t.qZA(),t.TgZ(14,"button",17),t.NdJ("click",function(){const o=t.CHM(i).$implicit,c=t.oxw(2);return t.KtG(c.remove(o))}),t.TgZ(15,"mat-icon"),t._uU(16,"delete"),t.qZA()()()()}if(2&e){const i=a.$implicit,s=t.oxw(2);t.xp6(2),t.Q6J("src",i.productImage||"assets/placeholder.png",t.LSH)("alt",i.productName),t.xp6(3),t.Oqu(i.productName),t.xp6(2),t.hij("\u20b9 ",t.xi3(8,6,i.productPrice||0,"1.2-2"),""),t.xp6(3),t.Q6J("disabled",s.isProcessing),t.xp6(4),t.Q6J("disabled",s.isProcessing)}}const T=()=>[10,20,50];function M(e,a){if(1&e){const i=t.EpF();t.TgZ(0,"div")(1,"div",6),t.YNc(2,w,17,9,"mat-card",7),t.qZA(),t.TgZ(3,"div",8)(4,"mat-paginator",9),t.NdJ("page",function(r){t.CHM(i);const o=t.oxw();return t.KtG(o.onPageChange(r))}),t.qZA()()()}if(2&e){const i=t.oxw();t.xp6(2),t.Q6J("ngForOf",i.displayedItems),t.xp6(2),t.Q6J("length",i.items.length)("pageSize",i.pageSize)("pageSizeOptions",t.DdM(4,T))}}function O(e,a){1&e&&(t.TgZ(0,"p",19),t._uU(1,"Your wishlist is empty"),t.qZA())}function U(e,a){if(1&e&&t.YNc(0,O,2,0,"p",18),2&e){const i=t.oxw();t.Q6J("ngIf",!i.isLoading)}}let W=(()=>{class e{constructor(i,s,r,o){this.wishlistService=i,this.cartService=s,this.authService=r,this.snackBar=o,this.items=[],this.displayedItems=[],this.pageSize=20,this.isLoading=!1,this.isProcessing=!1,this.userId=null,this.destroy$=new v.x}ngOnInit(){this.loadWishlist()}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}loadWishlist(){this.isLoading=!0;const i=this.authService.getCurrentUser();if(!i)return this.snackBar.open("Please login to view your wishlist","Close",{duration:3e3}),void(this.isLoading=!1);this.userId=i.userId,this.wishlistService.getUserWishlists(this.userId).pipe((0,g.R)(this.destroy$)).subscribe({next:s=>{this.items=s,this.updateDisplayedItems(0),this.isLoading=!1},error:s=>{404===s.status?(this.items=[],this.snackBar.open("Your wishlist is empty.","Close",{duration:3e3}),this.isLoading=!1):(console.error("Error loading wishlist:",s),this.items=[],this.snackBar.open("Failed to load wishlist","Close",{duration:3e3}),this.isLoading=!1)}})}updateDisplayedItems(i){const s=i*this.pageSize;this.displayedItems=this.items.slice(s,s+this.pageSize)}onPageChange(i){this.pageSize=i.pageSize,this.updateDisplayedItems(i.pageIndex)}remove(i){this.isProcessing=!0,this.wishlistService.delete(i.id).pipe((0,g.R)(this.destroy$)).subscribe({next:()=>{this.items=this.items.filter(c=>c.id!==i.id),this.snackBar.open("Removed from wishlist","Close",{duration:2e3});const s=Math.ceil(this.items.length/this.pageSize),o=Math.min(this.paginator?this.paginator.pageIndex:0,Math.max(0,s-1));this.updateDisplayedItems(o),this.isProcessing=!1},error:s=>{console.error("Error removing from wishlist:",s),this.snackBar.open("Failed to remove item","Close",{duration:3e3}),this.isProcessing=!1}})}addToCart(i){this.userId&&(this.isProcessing=!0,this.cartService.addItem(i.productId,1).pipe((0,g.R)(this.destroy$)).subscribe({next:()=>{this.snackBar.open("Added to cart","Close",{duration:2e3,panelClass:["success-snackbar"]}),this.isProcessing=!1},error:s=>{console.error("Error adding to cart:",s),this.snackBar.open("Failed to add to cart","Close",{duration:3e3}),this.isProcessing=!1}}))}static{this.\u0275fac=function(s){return new(s||e)(t.Y36(y),t.Y36(P.N),t.Y36(I.e),t.Y36(f.ux))}}static{this.\u0275cmp=t.Xpm({type:e,selectors:[["app-wishlist"]],viewQuery:function(s,r){if(1&s&&t.Gf(h.NW,5),2&s){let o;t.iGM(o=t.CRH())&&(r.paginator=o.first)}},standalone:!0,features:[t.jDz],decls:7,vars:3,consts:[[1,"wishlist-container"],["class","loading-spinner",4,"ngIf"],[4,"ngIf","ngIfElse"],["emptyState",""],[1,"loading-spinner"],["diameter","50"],[1,"grid"],["class","product-card",4,"ngFor","ngForOf"],[1,"paginator-wrap"],[3,"length","pageSize","pageSizeOptions","page"],[1,"product-card"],[1,"img-wrap"],["onerror","this.src='https://via.placeholder.com/220x220?text=No+Image'",3,"src","alt"],[1,"name"],[1,"price"],[1,"actions"],["mat-stroked-button","","color","primary",3,"disabled","click"],["mat-icon-button","","color","warn","aria-label","Remove",3,"disabled","click"],["class","empty",4,"ngIf"],[1,"empty"]],template:function(s,r){if(1&s&&(t.TgZ(0,"div",0)(1,"h2"),t._uU(2,"My Wishlist"),t.qZA(),t.YNc(3,Z,4,0,"div",1)(4,M,5,5,"div",2)(5,U,1,1,"ng-template",null,3,t.W1O),t.qZA()),2&s){const o=t.MAs(6);t.xp6(3),t.Q6J("ngIf",r.isLoading),t.xp6(1),t.Q6J("ngIf",!r.isLoading&&r.items.length)("ngIfElse",o)}},dependencies:[p.ez,p.sg,p.O5,p.JJ,d.ot,d.lW,d.RK,u.Ps,u.Hw,l.QW,l.a8,l.hq,l.dn,h.TU,h.NW,f.ZX,x.Cq,x.Ou],styles:[".wishlist-container[_ngcontent-%COMP%]{max-width:1200px;margin:2rem auto;padding:1rem}h2[_ngcontent-%COMP%]{margin:0 0 1.25rem;font-size:28px}.loading-spinner[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;padding:3rem;gap:1rem}.grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fill,minmax(220px,1fr));gap:16px}.product-card[_ngcontent-%COMP%]{display:flex;flex-direction:column;height:100%}.img-wrap[_ngcontent-%COMP%]{width:100%;padding-top:100%;position:relative;background:#f7f7f7;overflow:hidden}.img-wrap[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{position:absolute;inset:0;width:100%;height:100%;object-fit:cover}.name[_ngcontent-%COMP%]{margin:8px 0 4px;font-size:16px}.price[_ngcontent-%COMP%]{margin:0;color:#000000b3;font-weight:600}.actions[_ngcontent-%COMP%]{display:flex;gap:8px;align-items:center;margin-top:auto;padding:12px}.empty[_ngcontent-%COMP%]{color:#0009;margin-top:1rem;text-align:center}.paginator-wrap[_ngcontent-%COMP%]{margin-top:1rem}@media (max-width: 600px){h2[_ngcontent-%COMP%]{font-size:22px}.grid[_ngcontent-%COMP%]{gap:12px}}"]})}}return e})()}}]);