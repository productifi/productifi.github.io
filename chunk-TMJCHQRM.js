import{c as Z}from"./chunk-JDCC6IOV.js";import{e as P,f as R}from"./chunk-73HNPCUD.js";import{a as X,b as Y,c as B,f as q,h as z}from"./chunk-JX33CUBA.js";import{g as K}from"./chunk-I7QKGUOV.js";import"./chunk-KOH3MBIX.js";import{c as Q,g as j,j as U,m as N,s as H}from"./chunk-KU7RIE3I.js";import"./chunk-AESYL7IM.js";import{a as O,d as L,e as F}from"./chunk-4JKAHWEK.js";import"./chunk-5BDAPURH.js";import{ea as J,fa as G}from"./chunk-TBDOALTL.js";import{$a as h,$b as D,Fb as o,Gb as i,Lb as w,Ob as u,Qb as p,Sc as A,Vb as y,Wb as E,Xb as k,Zb as r,_c as W,cc as v,dc as S,ec as T,gc as V,ma as I,tb as b,ua as d,va as m,vb as _,xb as M}from"./chunk-J5RJCK57.js";var $=["canvas"],tt=["fileInput"];function et(g,x){if(g&1){let a=w();o(0,"div",7)(1,"label"),r(2,"Color:"),i(),o(3,"input",15),T("ngModelChange",function(t){d(a);let e=p();return S(e.drawColor,t)||(e.drawColor=t),m(t)}),i(),o(4,"label"),r(5,"Line Width:"),i(),o(6,"input",16),T("ngModelChange",function(t){d(a);let e=p();return S(e.lineWidth,t)||(e.lineWidth=t),m(t)}),i(),o(7,"span"),r(8),i()()}if(g&2){let a=p();h(3),v("ngModel",a.drawColor),h(3),v("ngModel",a.lineWidth),h(2),D("",a.lineWidth,"px")}}function it(g,x){if(g&1){let a=w();o(0,"div",7)(1,"button",17),u("click",function(){d(a);let t=p();return t.isCircleMode=!t.isCircleMode,t.isRectangleMode=!1,t.isCorrectMode=!1,t.isWrongMode=!1,m(t.isEraserMode=!1)}),o(2,"mat-icon"),r(3,"circle"),i(),r(4," Circle "),i(),o(5,"button",17),u("click",function(){d(a);let t=p();return t.isRectangleMode=!t.isRectangleMode,t.isCircleMode=!1,t.isCorrectMode=!1,t.isWrongMode=!1,m(t.isEraserMode=!1)}),o(6,"mat-icon"),r(7,"crop_square"),i(),r(8," Rectangle "),i(),o(9,"button",17),u("click",function(){d(a);let t=p();return t.isCorrectMode=!t.isCorrectMode,t.isCircleMode=!1,t.isRectangleMode=!1,t.isWrongMode=!1,m(t.isEraserMode=!1)}),o(10,"mat-icon"),r(11,"check_circle"),i(),r(12," Correct "),i(),o(13,"button",17),u("click",function(){d(a);let t=p();return t.isWrongMode=!t.isWrongMode,t.isCircleMode=!1,t.isRectangleMode=!1,t.isCorrectMode=!1,m(t.isEraserMode=!1)}),o(14,"mat-icon"),r(15,"cancel"),i(),r(16," Wrong "),i(),o(17,"button",17),u("click",function(){d(a);let t=p();return t.isEraserMode=!t.isEraserMode,t.isCircleMode=!1,t.isRectangleMode=!1,t.isCorrectMode=!1,m(t.isWrongMode=!1)}),o(18,"mat-icon"),r(19,"cleaning_services"),i(),r(20," Eraser "),i(),o(21,"button",17),u("click",function(){d(a);let t=p();return t.addText(),t.isCircleMode=!1,t.isRectangleMode=!1,t.isCorrectMode=!1,t.isWrongMode=!1,m(t.isEraserMode=!1)}),o(22,"mat-icon"),r(23,"text_fields"),i(),r(24," Text "),i()()}if(g&2){let a=p();h(),M("active",a.isCircleMode),h(4),M("active",a.isRectangleMode),h(4),M("active",a.isCorrectMode),h(4),M("active",a.isWrongMode),h(4),M("active",a.isEraserMode),h(4),M("active",a.isTextMode)}}function nt(g,x){if(g&1){let a=w();o(0,"div",7)(1,"input",18),T("ngModelChange",function(t){d(a);let e=p();return S(e.textToAdd,t)||(e.textToAdd=t),m(t)}),i(),o(2,"button",17),u("click",function(){d(a);let t=p();return m(t.addText())}),r(3,"Add Text"),i()()}if(g&2){let a=p();h(),v("ngModel",a.textToAdd)}}function ot(g,x){if(g&1){let a=w();o(0,"div",7)(1,"button",19),u("click",function(){d(a);let t=p();return m(t.clearCanvas())}),o(2,"mat-icon"),r(3,"delete"),i(),r(4," Clear Canvas "),i(),o(5,"button",20),u("click",function(){d(a);let t=p();return m(t.downloadImage())}),o(6,"mat-icon"),r(7,"download"),i(),r(8," Download "),i()()}}function at(g,x){g&1&&(o(0,"div",21)(1,"mat-icon",22),r(2,"image"),i(),o(3,"p",23),r(4,"Upload an image to start annotating"),i()())}var Ct=(()=>{let x=class x{constructor(){this.isDrawing=!1,this.imageLoaded=!1,this.originalImageData=null,this.lastDrawnImageData=null,this.drawColor="#FF0000",this.lineWidth=2,this.isCircleMode=!1,this.isRectangleMode=!1,this.isCorrectMode=!1,this.isWrongMode=!1,this.isEraserMode=!1,this.isTextMode=!1,this.textToAdd="",this.startX=0,this.startY=0}ngAfterViewInit(){this.canvas=this.canvasRef.nativeElement,this.canvas&&(this.ctx=this.canvas.getContext("2d"))}onImageSelected(n){let e=n.target.files?.[0];if(!e||!this.canvas||!this.ctx)return;let s=new FileReader;s.onload=c=>{let l=new Image;l.onload=()=>{this.canvas.width=l.width,this.canvas.height=l.height,this.ctx.drawImage(l,0,0),this.originalImageData=this.ctx.getImageData(0,0,this.canvas.width,this.canvas.height),this.lastDrawnImageData=this.ctx.getImageData(0,0,this.canvas.width,this.canvas.height),this.imageLoaded=!0},l.onerror=()=>{console.error("Failed to load image")},l.src=c.target?.result},s.readAsDataURL(e)}startDrawing(n){if(!this.imageLoaded||!this.canvas)return;let t=this.canvas.getBoundingClientRect();if(this.startX=n.clientX-t.left,this.startY=n.clientY-t.top,this.isDrawing=!0,this.isTextMode&&this.textToAdd){this.ctx.font="16px Arial",this.ctx.fillStyle=this.drawColor,this.ctx.fillText(this.textToAdd,this.startX,this.startY),this.lastDrawnImageData=this.ctx.getImageData(0,0,this.canvas.width,this.canvas.height),this.isDrawing=!1;return}}draw(n){if(!this.isDrawing||this.isTextMode||!this.canvas)return;let t=this.canvas.getBoundingClientRect(),e=n.clientX-t.left,s=n.clientY-t.top;if(this.ctx.strokeStyle=this.drawColor,this.ctx.lineWidth=this.lineWidth,this.ctx.lineCap="round",this.ctx.lineJoin="round",(this.isCircleMode||this.isRectangleMode||this.isCorrectMode||this.isWrongMode)&&this.lastDrawnImageData&&this.ctx.putImageData(this.lastDrawnImageData,0,0),this.isCircleMode){let c=Math.sqrt(Math.pow(e-this.startX,2)+Math.pow(s-this.startY,2));this.ctx.beginPath(),this.ctx.arc(this.startX,this.startY,c,0,2*Math.PI),this.ctx.stroke()}else if(this.isRectangleMode){let c=e-this.startX,l=s-this.startY;this.ctx.strokeRect(this.startX,this.startY,c,l)}else this.isCorrectMode?this.drawCheckmark(this.startX,this.startY,e,s):this.isWrongMode?this.drawWrongMark(this.startX,this.startY,e,s):this.isEraserMode?this.ctx.clearRect(e-this.lineWidth,s-this.lineWidth,this.lineWidth*2,this.lineWidth*2):(this.ctx.beginPath(),this.ctx.moveTo(this.startX,this.startY),this.ctx.lineTo(e,s),this.ctx.stroke(),this.startX=e,this.startY=s)}drawCheckmark(n,t,e,s){let c=Math.sqrt(Math.pow(e-n,2)+Math.pow(s-t,2));this.ctx.beginPath(),this.ctx.moveTo(n,t+c*.6),this.ctx.lineTo(n+c*.4,t+c),this.ctx.stroke(),this.ctx.beginPath(),this.ctx.moveTo(n+c*.4,t+c),this.ctx.lineTo(e,t-c*.3),this.ctx.stroke()}drawWrongMark(n,t,e,s){let c=Math.sqrt(Math.pow(e-n,2)+Math.pow(s-t,2)),l=(n+e)/2,C=(t+s)/2,f=c/2;this.ctx.beginPath(),this.ctx.moveTo(l-f,C-f),this.ctx.lineTo(l+f,C+f),this.ctx.stroke(),this.ctx.beginPath(),this.ctx.moveTo(l+f,C-f),this.ctx.lineTo(l-f,C+f),this.ctx.stroke()}stopDrawing(){this.isDrawing&&this.canvas&&(this.lastDrawnImageData=this.ctx.getImageData(0,0,this.canvas.width,this.canvas.height)),this.isDrawing=!1}addText(){this.isTextMode=!this.isTextMode,this.isTextMode||(this.textToAdd=""),this.isCircleMode=!1,this.isRectangleMode=!1,this.isCorrectMode=!1,this.isWrongMode=!1,this.isEraserMode=!1}clearCanvas(){!this.imageLoaded||!this.originalImageData||!this.canvas||(this.ctx.putImageData(this.originalImageData,0,0),this.lastDrawnImageData=this.ctx.getImageData(0,0,this.canvas.width,this.canvas.height))}downloadImage(){if(!this.imageLoaded||!this.canvas)return;let n=document.createElement("a");n.href=this.canvas.toDataURL("image/png"),n.download="annotated-screenshot.png",n.click()}openFileDialog(){this.fileInput&&this.fileInput.nativeElement&&this.fileInput.nativeElement.click()}};x.\u0275fac=function(t){return new(t||x)},x.\u0275cmp=I({type:x,selectors:[["app-screenshot-annotator"]],viewQuery:function(t,e){if(t&1&&(y($,5),y(tt,5)),t&2){let s;E(s=k())&&(e.canvasRef=s.first),E(s=k())&&(e.fileInput=s.first)}},standalone:!0,features:[V],decls:30,vars:6,consts:[["fileInput",""],["canvas",""],[1,"container"],["color","primary"],["mat-icon-button","","disabled",""],[1,"content"],[1,"controls-card"],[1,"control-group"],["mat-raised-button","","color","primary",3,"click"],["type","file","accept","image/*","hidden","",3,"change"],["class","control-group",4,"ngIf"],[1,"canvas-card"],[1,"canvas-wrapper"],[2,"border","1px solid #ddd","display","block","width","100%","max-height","600px","cursor","crosshair",3,"mousedown","mousemove","mouseup","mouseleave","hidden"],["class","no-image","style","height: 300px; display: flex; flex-direction: column; align-items: center; justify-content: center;",4,"ngIf"],["type","color",1,"color-input",3,"ngModelChange","ngModel"],["type","range","min","1","max","20",1,"range-input",3,"ngModelChange","ngModel"],["mat-stroked-button","",3,"click"],["type","text","placeholder","Enter text to add",1,"text-input",3,"ngModelChange","ngModel"],["mat-raised-button","","color","warn",3,"click"],["mat-raised-button","","color","accent",3,"click"],[1,"no-image",2,"height","300px","display","flex","flex-direction","column","align-items","center","justify-content","center"],[2,"font-size","64px","width","64px","height","64px","color","#999"],[2,"color","#999","font-size","16px","margin-top","16px"]],template:function(t,e){if(t&1){let s=w();o(0,"div",2)(1,"mat-toolbar",3)(2,"button",4)(3,"mat-icon"),r(4,"edit"),i()(),o(5,"span"),r(6,"Screenshot Annotator"),i()(),o(7,"div",5)(8,"mat-card",6)(9,"mat-card-header")(10,"mat-card-title"),r(11,"Drawing Tools"),i()(),o(12,"mat-card-content")(13,"div",7)(14,"button",8),u("click",function(){return d(s),m(e.openFileDialog())}),o(15,"mat-icon"),r(16,"upload"),i(),r(17," Upload Image "),i(),o(18,"input",9,0),u("change",function(l){return d(s),m(e.onImageSelected(l))}),i()(),b(20,et,9,3,"div",10)(21,it,25,12,"div",10)(22,nt,4,1,"div",10)(23,ot,9,0,"div",10),i()(),o(24,"mat-card",11)(25,"mat-card-content")(26,"div",12)(27,"canvas",13,1),u("mousedown",function(l){return d(s),m(e.startDrawing(l))})("mousemove",function(l){return d(s),m(e.draw(l))})("mouseup",function(){return d(s),m(e.stopDrawing())})("mouseleave",function(){return d(s),m(e.stopDrawing())}),i(),b(29,at,5,0,"div",14),i()()()()()}t&2&&(h(20),_("ngIf",e.imageLoaded),h(),_("ngIf",e.imageLoaded),h(),_("ngIf",e.imageLoaded&&e.isTextMode),h(),_("ngIf",e.imageLoaded),h(4),_("hidden",!e.imageLoaded),h(2),_("ngIf",!e.imageLoaded))},dependencies:[W,A,H,Q,N,j,U,G,J,R,P,F,O,L,z,X,B,q,Y,K,Z],styles:[".container[_ngcontent-%COMP%]{display:flex;flex-direction:column;height:100%}mat-toolbar[_ngcontent-%COMP%]{margin-bottom:1rem}.content[_ngcontent-%COMP%]{padding:1rem;flex:1;overflow-y:auto;display:flex;gap:1rem}.controls-card[_ngcontent-%COMP%]{flex:0 0 300px;height:fit-content;position:sticky;top:1rem}.canvas-card[_ngcontent-%COMP%]{flex:1;display:flex;flex-direction:column}.control-group[_ngcontent-%COMP%]{margin-bottom:1rem;display:flex;align-items:center;gap:.5rem;flex-wrap:wrap}.color-input[_ngcontent-%COMP%]{width:50px;height:40px;cursor:pointer;border:none;border-radius:4px}.range-input[_ngcontent-%COMP%]{flex:1;min-width:100px}.text-input[_ngcontent-%COMP%]{padding:.5rem;border:1px solid #ddd;border-radius:4px;flex:1}.canvas-wrapper[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;flex:1;overflow:auto;background-color:#f5f5f5}canvas[_ngcontent-%COMP%]{border:2px solid #ddd;border-radius:4px;cursor:crosshair;max-width:100%;max-height:600px}.no-image[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;flex:1;color:#999;gap:1rem}.no-image[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:4rem;width:4rem;height:4rem}button.active[_ngcontent-%COMP%]{background-color:#673ab7;color:#fff}label[_ngcontent-%COMP%]{font-weight:500;min-width:100px}@media (max-width: 900px){.content[_ngcontent-%COMP%]{flex-direction:column}.controls-card[_ngcontent-%COMP%]{flex:0 1 auto;position:relative;top:auto}}"]});let g=x;return g})();export{Ct as ScreenshotAnnotatorComponent};
