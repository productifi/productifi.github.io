import{ca as p,i as a,m as o}from"./chunk-J5RJCK57.js";var d=(()=>{let n=class n{constructor(){this._speaking$=new o(!1),this.speaking$=this._speaking$.asObservable()}getVoices(){return new Promise(i=>{let e=window.speechSynthesis,t=e.getVoices();if(t.length){i(t);return}let s=()=>{t=e.getVoices(),i(t),e.removeEventListener("voiceschanged",s)};e.addEventListener("voiceschanged",s)})}speak(i,e={}){if(!("speechSynthesis"in window)){console.warn("Speech Synthesis not supported by this browser");return}this.cancel(),this.utterance=new SpeechSynthesisUtterance(i);let t=window.speechSynthesis;if(e.voiceUri){let r=(t.getVoices()||[]).find(h=>h.voiceURI===e.voiceUri||h.name===e.voiceUri);r&&(this.utterance.voice=r)}this.utterance.rate=e.rate??1,this.utterance.pitch=e.pitch??1,this.utterance.volume=e.volume??1,this.utterance.onstart=()=>this._speaking$.next(!0),this.utterance.onend=()=>this._speaking$.next(!1),this.utterance.onerror=()=>this._speaking$.next(!1),t.speak(this.utterance)}pause(){"speechSynthesis"in window&&window.speechSynthesis.speaking&&(window.speechSynthesis.pause(),this._speaking$.next(!1))}resume(){"speechSynthesis"in window&&window.speechSynthesis.paused&&(window.speechSynthesis.resume(),this._speaking$.next(!0))}cancel(){"speechSynthesis"in window&&window.speechSynthesis.cancel(),this._speaking$.next(!1)}fetchAudio(i,e={}){return new a(t=>{fetch("/api/tts",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({text:i,options:e})}).then(s=>{if(!s.ok)throw new Error("Server TTS request failed");return s.blob()}).then(s=>{t.next(s),t.complete()}).catch(s=>t.error(s))})}};n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=p({token:n,factory:n.\u0275fac,providedIn:"root"});let c=n;return c})();export{d as a};
